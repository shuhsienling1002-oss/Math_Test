import json
import random

# ==========================================
# é¡Œåº«è£½é€ å·¥å»  (V2.0 - æ ¼å¼å°æ¥ç‰ˆ)
# ==========================================

def create_dataset():
    # 1. å®šç¾©èˆ‡ APP åŒæ­¥çš„å–®å…ƒçµæ§‹
    database = {
        "3-1 è­‰æ˜èˆ‡æ¨ç†": [],
        "3-2 ä¸‰è§’å½¢çš„å¤–å¿ƒ": [],
        "3-3 ä¸‰è§’å½¢çš„å…§å¿ƒ": [],
        "3-4 ä¸‰è§’å½¢çš„é‡å¿ƒ": [],
        "4-1 å› å¼åˆ†è§£æ³•": [],
        "4-2 é…æ–¹æ³•èˆ‡å…¬å¼è§£": [],
        "4-3 æ‡‰ç”¨å•é¡Œ": []
    }

    print("ğŸš€ é–‹å§‹ç”Ÿç”¢é¡Œåº«...")

    # ---------------------------------------------------------
    # å–®å…ƒ 3-1: è­‰æ˜èˆ‡æ¨ç†
    # ---------------------------------------------------------
    for _ in range(50): # ç¯„ä¾‹ç”Ÿç”¢ 50 é¡Œï¼Œå¯è‡ªè¡Œå¢åŠ 
        # é¡Œå‹ï¼šå…¨ç­‰æ€§è³ª
        prop = random.choice(["SSS", "SAS", "ASA", "AAS", "RHS"])
        options = ["å¿…å…¨ç­‰", "ä¸ä¸€å®šå…¨ç­‰", "é¢ç©ç›¸ç­‰ä½†å½¢ç‹€ä¸åŒ", "ç„¡æ³•åˆ¤æ–·"]
        random.shuffle(options)
        database["3-1 è­‰æ˜èˆ‡æ¨ç†"].append({
            "q": f"è‹¥å…©å€‹ä¸‰è§’å½¢æ»¿è¶³ã€Œ{prop}ã€å°æ‡‰ç›¸ç­‰ï¼Œå‰‡å®ƒå€‘çš„é—œä¿‚ç‚ºä½•ï¼Ÿ",
            "options": options,
            "ans": "å¿…å…¨ç­‰",
            "expl": f"{prop} æ˜¯å…¨ç­‰åˆ¤åˆ¥æ€§è³ªä¹‹ä¸€ã€‚",
            "svg": "geometry_sas",
            "params": {}
        })
        
        # é¡Œå‹ï¼šè§’åº¦è¨ˆç®—
        a, b = random.randint(20, 80), random.randint(20, 80)
        ans = str(a+b)
        opts = [ans, str(180-(a+b)), "180", "90"]
        random.shuffle(opts)
        database["3-1 è­‰æ˜èˆ‡æ¨ç†"].append({
            "q": f"â–³ABC ä¸­ï¼Œâˆ A={a}Â°ï¼Œâˆ B={b}Â°ï¼Œå‰‡ âˆ C çš„å¤–è§’æ˜¯å¤šå°‘åº¦ï¼Ÿ",
            "options": opts,
            "ans": ans,
            "expl": f"å¤–è§’ = ä¸ç›¸é„°å…©å…§è§’å’Œï¼š{a} + {b} = {a+b}ã€‚",
            "svg": "general_triangle",
            "params": {"angle_a": a, "angle_b": b}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 3-2: å¤–å¿ƒ
    # ---------------------------------------------------------
    for _ in range(50):
        # é¡Œå‹ï¼šç›´è§’ä¸‰è§’å½¢å¤–æ¥åœ“åŠå¾‘
        c = random.randint(5, 30) * 2
        r = c // 2
        opts = [str(r), str(c), str(c*2), str(r-1)]
        random.shuffle(opts)
        database["3-2 ä¸‰è§’å½¢çš„å¤–å¿ƒ"].append({
            "q": f"ç›´è§’ä¸‰è§’å½¢æ–œé‚Šé•·ç‚º {c}ï¼Œæ±‚å…¶ã€Œå¤–æ¥åœ“åŠå¾‘ã€ï¼Ÿ",
            "options": opts,
            "ans": str(r),
            "expl": f"ç›´è§’ä¸‰è§’å½¢å¤–å¿ƒåœ¨æ–œé‚Šä¸­é»ï¼ŒåŠå¾‘ = æ–œé‚Š/2 = {c}/2 = {r}ã€‚",
            "svg": "right_triangle_circumcenter",
            "params": {}
        })

        # é¡Œå‹ï¼šæƒ…å¢ƒé¡Œ
        database["3-2 ä¸‰è§’å½¢çš„å¤–å¿ƒ"].append({
            "q": "è¦åœ¨ä¸€å€‹ä¸‰è§’å½¢å…¬åœ’çš„ä¸‰å€‹é ‚é»å„è¨­ä¸€å€‹å…¥å£ï¼Œä¸¦åœ¨å…¬åœ’å…§å»ºä¸€åº§å»æ‰€åˆ°ä¸‰å…¥å£è·é›¢ç›¸ç­‰ï¼Œå»æ‰€æ‡‰è“‹åœ¨ï¼Ÿ",
            "options": ["å¤–å¿ƒ", "å…§å¿ƒ", "é‡å¿ƒ", "å‚å¿ƒ"],
            "ans": "å¤–å¿ƒ",
            "expl": "åˆ°ä¸‰é ‚é»ç­‰è·æ˜¯å¤–å¿ƒçš„æ€§è³ªã€‚",
            "svg": "triangle_circumcenter",
            "params": {}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 3-3: å…§å¿ƒ
    # ---------------------------------------------------------
    for _ in range(50):
        # é¡Œå‹ï¼šè§’åº¦è¨ˆç®—
        deg = random.choice([40, 50, 60, 70, 80])
        ans_val = 90 + deg // 2
        opts = [str(ans_val), str(180-deg), str(90+deg), str(2*deg)]
        random.shuffle(opts)
        database["3-3 ä¸‰è§’å½¢çš„å…§å¿ƒ"].append({
            "q": f"I ç‚ºå…§å¿ƒï¼Œè‹¥ âˆ A = {deg}Â°ï¼Œæ±‚ âˆ BICï¼Ÿ",
            "options": opts,
            "ans": str(ans_val),
            "expl": f"å…§å¿ƒè§’åº¦å…¬å¼ï¼š90 + A/2 = 90 + {deg//2} = {ans_val}ã€‚",
            "svg": "triangle_incenter_angle",
            "params": {"a": deg}
        })
        
        # é¡Œå‹ï¼šæ¦‚å¿µ
        database["3-3 ä¸‰è§’å½¢çš„å…§å¿ƒ"].append({
            "q": "ä¸‰è§’å½¢çš„å…§å¿ƒæ˜¯å“ªä¸‰æ¢ç·šçš„äº¤é»ï¼Ÿ",
            "options": ["è§’å¹³åˆ†ç·š", "ä¸­å‚ç·š", "ä¸­ç·š", "é«˜"],
            "ans": "è§’å¹³åˆ†ç·š",
            "expl": "å…§å¿ƒæ˜¯ä¸‰æ¢è§’å¹³åˆ†ç·šçš„äº¤é»ã€‚",
            "svg": "triangle_incenter_concept",
            "params": {}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 3-4: é‡å¿ƒ
    # ---------------------------------------------------------
    for _ in range(50):
        # é¡Œå‹ï¼šé•·åº¦è¨ˆç®—
        m = random.randint(6, 30) * 3
        ag = int(m * 2 / 3)
        opts = [str(ag), str(m), str(int(m/2)), str(int(m/3))]
        random.shuffle(opts)
        database["3-4 ä¸‰è§’å½¢çš„é‡å¿ƒ"].append({
            "q": f"è‹¥ä¸­ç·š AD é•·ç‚º {m}ï¼ŒG ç‚ºé‡å¿ƒï¼Œæ±‚ AG çš„é•·åº¦ï¼Ÿ",
            "options": opts,
            "ans": str(ag),
            "expl": f"é‡å¿ƒæ€§è³ªï¼šé ‚é»åˆ°é‡å¿ƒ = 2/3 ä¸­ç·š = {ag}ã€‚",
            "svg": "triangle_centroid",
            "params": {"m": m}
        })
        
        # é¡Œå‹ï¼šç‰©ç†æ€§è³ª
        database["3-4 ä¸‰è§’å½¢çš„é‡å¿ƒ"].append({
            "q": "æƒ³è¦ç”¨ä¸€æ ¹æ‰‹æŒ‡é ‚ä½ä¸€å¡Šä¸‰è§’å½¢æœ¨æ¿ä¸¦ä¿æŒå¹³è¡¡ï¼Œæ”¯é»æ‡‰é¸åœ¨ï¼Ÿ",
            "options": ["é‡å¿ƒ", "å¤–å¿ƒ", "å…§å¿ƒ", "éš¨ä¾¿ä¸€é»"],
            "ans": "é‡å¿ƒ",
            "expl": "é‡å¿ƒæ˜¯ç‰©ç†ä¸Šçš„å¹³è¡¡é»ã€‚",
            "svg": "none",
            "params": {}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 4-1: å› å¼åˆ†è§£
    # ---------------------------------------------------------
    for _ in range(50):
        r1, r2 = random.randint(1, 5), random.randint(-5, -1)
        opts = [f"{r1} æˆ– {r2}", f"{-r1} æˆ– {-r2}", f"{r1} æˆ– {-r2}", "ç„¡è§£"]
        random.shuffle(opts)
        database["4-1 å› å¼åˆ†è§£æ³•"].append({
            "q": f"è§£æ–¹ç¨‹å¼ (x - {r1})(x - {r2}) = 0ï¼Ÿ",
            "options": opts,
            "ans": f"{r1} æˆ– {r2}",
            "expl": f"ä»¤æ‹¬è™Ÿç‚º 0ï¼Œå¯å¾— x={r1} æˆ– x={r2}ã€‚",
            "svg": "roots_line",
            "params": {"r1": r1, "r2": r2}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 4-2: é…æ–¹æ³•
    # ---------------------------------------------------------
    for _ in range(50):
        b = random.choice([2, 4, 6, 8])
        c = random.randint(1, 3)
        d_val = b*b - 4*c
        opts = [str(d_val), str(d_val+4), str(d_val-4), "0"]
        random.shuffle(opts)
        database["4-2 é…æ–¹æ³•èˆ‡å…¬å¼è§£"].append({
            "q": f"æ±‚ xÂ² + {b}x + {c} = 0 çš„åˆ¤åˆ¥å¼ Dï¼Ÿ",
            "options": opts,
            "ans": str(d_val),
            "expl": f"D = bÂ² - 4ac = {b*b} - 4 = {d_val}ã€‚",
            "svg": "parabola_d_neg" if d_val < 0 else "none",
            "params": {}
        })

    # ---------------------------------------------------------
    # å–®å…ƒ 4-3: æ‡‰ç”¨å•é¡Œ
    # ---------------------------------------------------------
    for _ in range(50):
        s = random.randint(5, 20)
        area = s * s
        opts = [str(s), str(area), str(s*2), str(s+5)]
        random.shuffle(opts)
        database["4-3 æ‡‰ç”¨å•é¡Œ"].append({
            "q": f"æŸæ­£æ–¹å½¢è¾²åœ°é¢ç©ç‚º {area} å¹³æ–¹å…¬å°ºï¼Œæ±‚é‚Šé•·ï¼Ÿ",
            "options": opts,
            "ans": str(s),
            "expl": f"é‚Šé•· = âˆš{area} = {s}ã€‚",
            "svg": "area_square",
            "params": {"s": s}
        })

    # å¯«å…¥æª”æ¡ˆ
    with open("questions.json", "w", encoding="utf-8") as f:
        json.dump(database, f, ensure_ascii=False, indent=2)
    
    print(f"âœ… æˆåŠŸç”Ÿæˆ questions.jsonï¼\nç¸½é¡Œæ•¸ï¼š{sum(len(v) for v in database.values())}")

if __name__ == "__main__":
    create_dataset()
